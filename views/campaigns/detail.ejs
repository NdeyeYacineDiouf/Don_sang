<h1><%= campaign.title %></h1>
<p><strong>Description :</strong> <%= campaign.description %></p>
<p><strong>Lieu :</strong> <%= campaign.location %></p>
<p><strong>Date :</strong> du <%= campaign.startDate.toLocaleDateString() %> au <%= campaign.endDate.toLocaleDateString() %></p>
<p><strong>Horaire :</strong> <%= campaign.startTime %> - <%= campaign.endTime %></p>

<h3>CrÃ©neaux disponibles :</h3>

<% if (slots && slots.length > 0) { %>
  <div class="slots-container">
    <% 
    // Organiser les crÃ©neaux par jour
    const slotsByDay = {};
    slots.forEach(slot => {
      const dayStr = slot.day.toLocaleDateString();
      if (!slotsByDay[dayStr]) {
        slotsByDay[dayStr] = [];
      }
      slotsByDay[dayStr].push(slot);
    });
    
    // Afficher les crÃ©neaux organisÃ©s par jour
    Object.keys(slotsByDay).forEach(day => { 
    %>
      <div class="day-slots">
        <h4>ğŸ“… <%= day %></h4>
        <ul class="slots-list">
          <% slotsByDay[day].forEach(slot => { %>
            <li class="slot-item">
              ğŸ•‘ <%= slot.startTime %> - <%= slot.endTime %>
              <span class="places-info">
                Places restantes: <%= slot.maxPeople - slot.reserved %>/<%= slot.maxPeople %>
              </span>
              <% if ((slot.maxPeople - slot.reserved) > 0) { %>
                <form action="/api/slots/<%= slot._id %>/reserve" method="POST" style="display: inline;">
                  <button type="submit" class="reserve-btn">RÃ©server</button>
                </form>
              <% } else { %>
                <span class="full-label">Complet</span>
              <% } %>
            </li>
          <% }) %>
        </ul>
      </div>
    <% }) %>
  </div>
<% } else { %>
  <p>Aucun crÃ©neau disponible pour cette campagne.</p>
<% } %>

<% if (isAdmin) { %>
  <div class="admin-section">
    <h3>Ajouter un crÃ©neau</h3>
    <form action="/campaigns/<%= campaign._id %>/slots" method="POST">
      <div class="form-group">
        <label for="day">Date:</label>
        <input type="date" id="day" name="day" required>
      </div>
      <div class="form-group">
        <label for="startTime">Heure de dÃ©but:</label>
        <input type="time" id="startTime" name="startTime" required>
      </div>
      <div class="form-group">
        <label for="endTime">Heure de fin:</label>
        <input type="time" id="endTime" name="endTime" required>
      </div>
      <div class="form-group">
        <label for="maxPeople">Nombre de places:</label>
        <input type="number" id="maxPeople" name="maxPeople" value="<%= campaign.maxPeoplePerSlot %>" required>
      </div>
      <button type="submit" class="add-slot-btn">Ajouter ce crÃ©neau</button>
    </form>
  </div>
<% } %>

<a href="/api/campaigns">
  <button class="back-btn">Retour Ã  la liste</button>
</a>

